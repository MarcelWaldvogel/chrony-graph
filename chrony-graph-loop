#!/bin/sh

INTERVAL=61
exclude="--exclude index.html.tmpl --exclude notes --exclude run-cron"

# Do not use linlog axes for Remote Clocks Summary for readability
export FORCE_LINEAR_ALLSTAR=1

./substitute.sh web/*.IN
rsync -au $exclude web/. /web
while true; do
  (cd week && FREQ=Weekly ../bin/run --plus-svg 7)
  rsync -au $exclude week /web
  for i in 1 2 3 4 5 6; do
    (cd day && FREQ=Daily ../bin/run --plus-svg 1)
    rsync -au $exclude day /web
    sleep $INTERVAL
  done
done
